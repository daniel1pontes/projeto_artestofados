<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Artestofados - Dashboard</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app-container">
        <!-- SIDEBAR -->
        <aside class="sidebar">
            <div class="logo-container">
                <img src="build/logo_cortada.png" alt="Logo Artestofados" class="logo">
            </div>

            <nav class="sidebar-nav">
                <button class="nav-button active" onclick="switchTab('chatbot')">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
                    </svg>
                    <span>Chatbot</span>
                </button>

                <button class="nav-button" onclick="switchTab('gerador')">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                        <polyline points="14 2 14 8 20 8"/>
                    </svg>
                    <span>Gerador de OS</span>
                </button>

                <button class="nav-button" onclick="switchTab('banco')">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/>
                    </svg>
                    <span>Banco de OS</span>
                </button>
            </nav>

            <div class="sidebar-footer">
                <div class="server-status">
                    <span class="status-dot" id="statusDot"></span>
                    <span id="serverStatus" class="status-text">Conectado</span>
                </div>
                <p id="serverUrl" class="server-url"></p>
            </div>
        </aside>

        <!-- MAIN CONTENT -->
        <main class="main-content">
            <!-- TAB 1: CHATBOT -->
            <div id="chatbot" class="tab-content active">
                <div class="page-header">
                    <h1>ü§ñ Controle do Chatbot</h1>
                    <p>Gerencie o bot do WhatsApp com IA integrada</p>
                </div>

                <div id="chatbotAlert"></div>

                <!-- Status e Controles -->
                <div class="card">
                    <div class="card-header">
                        <h3>
                            <span class="status-indicator offline" id="botStatus"></span>
                            Status do Bot
                        </h3>
                    </div>
                    <div class="card-body">
                        <p id="botStatusText" class="status-description">Bot desconectado</p>
                        
                        <!-- Bot√£o Conectar -->
                        <div id="connectBtnContainer" class="button-group">
                            <button id="connectWhatsAppBtn" class="btn btn-success btn-lg" onclick="connectWhatsApp()">
                                üì± Conectar ao WhatsApp
                            </button>
                        </div>

                        <!-- Bot√µes de Controle -->
                        <div id="botControlButtons" class="button-group" style="display: none;">
                            <button class="btn btn-warning" onclick="restartBot()">
                                üîÑ Reiniciar Bot
                            </button>
                            <button class="btn btn-info" onclick="testAI()">
                                ü§ñ Testar IA
                            </button>
                            <button class="btn btn-danger" onclick="disconnectBot()">
                                üîå Desconectar
                            </button>
                        </div>
                    </div>
                </div>

                <!-- QR Code -->
                <div id="qrCodeCard" class="card" style="display: none;">
                    <div class="card-header">
                        <h3>üì± Escaneie o QR Code</h3>
                    </div>
                    <div class="card-body text-center">
                        <img id="qrCodeImage" src="" alt="QR Code" style="max-width: 300px; margin: 20px auto; display: none;">
                        <p id="qrCodeStatus" class="qr-status">Aguardando QR Code...</p>
                    </div>
                </div>

                <!-- Usu√°rios Pausados -->
                <div class="card">
                    <div class="card-header">
                        <h3>‚è∏Ô∏è Usu√°rios com Bot Pausado</h3>
                        <button class="btn btn-sm btn-secondary" onclick="loadPausedUsers()">
                            üîÑ Atualizar
                        </button>
                    </div>
                    <div class="card-body">
                        <p class="info-text">
                            Quando voc√™ responde manualmente no WhatsApp, o bot pausa por 2 horas para aquele cliente.
                        </p>
                        <div id="pausedUsersTable" class="table-container">
                            <p class="loading-text">Carregando...</p>
                        </div>
                    </div>
                </div>

                <!-- Atendimentos -->
                <div class="card">
                    <div class="card-header">
                        <h3>üìä Atendimentos Registrados</h3>
                    </div>
                    <div class="card-body">
                        <div id="atendimentosTable" class="table-container">
                            <p class="loading-text">Carregando atendimentos...</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- TAB 2: GERADOR DE OS -->
            <div id="gerador" class="tab-content">
                <div class="page-header">
                    <h1>üìÑ Gerador de Ordem de Servi√ßo</h1>
                    <p>Crie e gere PDFs de ordens de servi√ßo</p>
                </div>

                <div id="osAlert"></div>

                <div class="card">
                    <div class="card-header">
                        <h3>Nova Ordem de Servi√ßo</h3>
                    </div>
                    <div class="card-body">
                        <form id="osForm">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Nome do Cliente *</label>
                                    <input type="text" class="form-control" id="nomeCliente" required 
                                           placeholder="Digite o nome do cliente">
                                </div>

                                <div class="form-group">
                                    <label>Prazo de Entrega *</label>
                                    <input type="date" class="form-control" id="prazoEntrega" required>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label>Forma de Pagamento *</label>
                                    <input type="text" class="form-control" id="formaPagamento" required
                                           placeholder="Ex: PIX, Dinheiro, Cart√£o...">
                                </div>

                                <div class="form-group">
                                    <label>Desconto (%)</label>
                                    <input type="number" class="form-control" id="desconto" 
                                           min="0" max="100" value="0" step="0.01">
                                </div>
                            </div>

                            <div class="form-group">
                                <label>Imagens (opcional)</label>
                                <input type="file" id="imagens" multiple accept="image/*" style="display: none;">
                                <button type="button" class="btn btn-secondary" onclick="document.getElementById('imagens').click()">
                                    üì∑ Adicionar Imagens
                                </button>
                                <div id="imagensPreview" class="images-preview"></div>
                            </div>

                            <div class="items-section">
                                <div class="section-header">
                                    <h4>Itens do Servi√ßo</h4>
                                    <button type="button" class="btn btn-primary btn-sm" onclick="addItem()">
                                        + Adicionar Item
                                    </button>
                                </div>
                                <div id="itensContainer"></div>
                            </div>

                            <div class="total-section">
                                <label>Total Geral:</label>
                                <span id="totalGeral" class="total-value">R$ 0,00</span>
                            </div>

                            <div class="form-actions">
                                <button type="submit" class="btn btn-success btn-lg">
                                    üìÑ Gerar Ordem de Servi√ßo
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- TAB 3: BANCO DE OS -->
            <div id="banco" class="tab-content">
                <div class="page-header">
                    <h1>üóÇÔ∏è Banco de Ordens de Servi√ßo</h1>
                    <p>Visualize e baixe as ordens de servi√ßo geradas</p>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3>Ordens de Servi√ßo</h3>
                        <div class="search-box">
                            <input type="text" class="form-control" id="searchOS" 
                                   placeholder="üîç Buscar por nome do cliente...">
                        </div>
                    </div>
                    <div class="card-body">
                        <div id="osListTable" class="table-container">
                            <p class="loading-text">Carregando ordens de servi√ßo...</p>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="renderer.js"></script>
</body>
</html>