<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Artestofados - Dashboard</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
   <div class="app-container">
        <!-- SIDEBAR -->
        <aside class="sidebar">
            <div class="logo-container">
                <div class="logo">
                    <img src="build/logo_cortada.png" alt="Logo Artestofados">
                </div>
            </div>

            <nav class="sidebar-nav">
                <button class="nav-button active" onclick="switchTab('chatbot')">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
                    </svg>
                    <span>Chatbot</span>
                </button>

                <button class="nav-button" onclick="switchTab('gerador')">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                        <polyline points="14 2 14 8 20 8"/>
                        <line x1="16" y1="13" x2="8" y2="13"/>
                        <line x1="16" y1="17" x2="8" y2="17"/>
                        <polyline points="10 9 9 9 8 9"/>
                    </svg>
                    <span>Gerador de OS</span>
                </button>

                <button class="nav-button" onclick="switchTab('banco')">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/>
                    </svg>
                    <span>Banco de OS</span>
                </button>
            </nav>

            <div class="sidebar-footer">
                <div class="server-status">
                    <span class="status-dot" id="statusDot"></span>
                    <div class="status-info">
                        <span id="serverStatus" class="status-text">Conectado</span>
                        <span id="serverUrl" class="status-url"></span>
                    </div>
                </div>
            </div>
        </aside>

        <!-- MAIN CONTENT -->
        <main class="main-content">
            <div class="header">
                <h1>Sistema de Gerenciamento</h1>
                <p>Atendimentos e Ordens de Servi√ßo</p>
            </div>

            <div class="content">
                <!-- TAB CHATBOT -->
                <div id="chatbot" class="tab-content active">
                    <!-- ALERT AREA -->
                    <div id="chatbotAlert"></div>

                    <!-- STATUS CARD -->
                    <div class="status-card">
                        <h3>
                            <span class="status-indicator offline" id="botStatus"></span>
                            Status do Bot
                        </h3>
                        <p id="botStatusText">Bot desconectado</p>
                        
                        <!-- BOT√ÉO DE CONECTAR -->
                        <div class="button-group">
                            <button id="connectWhatsAppBtn" class="btn btn-success" onclick="connectWhatsApp()">
                                üì± Conectar ao WhatsApp
                            </button>
                        </div>

                        <!-- BOT√ÉO DE DESCONECTAR (Simplificado) -->
                        <div id="botControlButtons" class="button-group" style="display: none;">
                            <button class="btn btn-danger" onclick="disconnectBot()">
                                üîå Desconectar Bot
                            </button>
                        </div>
                    </div>

                    <!-- QR CODE CARD -->
                    <div id="qrCodeCard" class="card" style="display: none;">
                        <h3>üì± QR Code WhatsApp</h3>
                        <div style="text-align: center;">
                            <img id="qrCodeImage" src="" alt="QR Code" style="max-width: 300px; margin: 20px 0; display: none;">
                            <p id="qrCodeStatus">Aguardando QR Code...</p>
                        </div>
                    </div>

                    <!-- USU√ÅRIOS PAUSADOS -->
                    <div class="card">
                        <h3>‚è∏Ô∏è Usu√°rios com Bot Pausado</h3>
                        <p style="color: #6c757d; font-size: 0.9em; margin-bottom: 15px;">
                            Quando voc√™ responde manualmente no WhatsApp, o bot pausa automaticamente por 2 horas para aquele cliente.
                            Use o bot√£o "Reativar" se quiser que o bot volte a responder antes desse tempo.
                        </p>
                        
                        <div id="pausedUsersTable">
                            <p style="text-align: center; padding: 20px; color: #6c757d;">
                                Carregando...
                            </p>
                        </div>
                        
                        <div style="margin-top: 15px; display: flex; gap: 10px; flex-wrap: wrap;">
                            <button class="btn btn-secondary" onclick="loadPausedUsers()">
                                üîÑ Atualizar Lista
                            </button>
                            <button class="btn btn-primary" onclick="showPauseHelp()">
                                ‚ùì Como Funciona
                            </button>
                        </div>
                    </div>

                    <!-- ATENDIMENTOS -->
                    <div class="card">
                        <h3>üìä Atendimentos Registrados</h3>
                        <div id="atendimentosTable">
                            <p>Lista de atendimentos aparecer√° aqui...</p>
                        </div>
                    </div>
                </div>

                <!-- TAB GERADOR DE OS -->
                <div id="gerador" class="tab-content">
                <div class="card">
                    <h3>üìÑ Nova Ordem de Servi√ßo</h3>
                    
                    <div id="osAlert"></div>
                    
                    <form id="osForm">
                    <div class="form-group">
                        <label>Nome do Cliente *</label>
                        <input type="text" class="form-control" id="nomeCliente" required>
                    </div>

                    <div class="form-group">
                        <label>Prazo de Entrega *</label>
                        <input type="date" class="form-control" id="prazoEntrega" required>
                    </div>

                    <div class="form-group">
                        <label>Forma de Pagamento *</label>
                        <input type="text" class="form-control" id="formaPagamento"
                            placeholder="Ex: PIX, Dinheiro, Cart√£o de Cr√©dito..." required>
                    </div>

                    <div class="form-group">
                        <label>Desconto (%)</label>
                        <input type="number" class="form-control" id="desconto" min="0" max="100" value="0" step="0.01">
                    </div>

                    <div class="form-group">
                        <label>Imagens (opcional)</label>
                        <input type="file" id="imagens" multiple accept="image/*" style="display: none;">
                        <button type="button" class="btn btn-secondary" onclick="document.getElementById('imagens').click()">
                            + Adicionar Imagens
                        </button>
                        <div id="imagensPreview" style="margin-top: 10px; display: flex; flex-wrap: wrap; gap: 10px;"></div>
                        <small>Voc√™ pode adicionar v√°rias imagens. Elas ser√£o acumuladas.</small>
                    </div>

                    <h4 style="margin: 25px 0 15px 0;">Itens do Servi√ßo</h4>
                    <div id="itensContainer"></div>

                    <button type="button" class="btn-add" onclick="addItem()">+ Adicionar Item</button>

                    <div style="margin-top: 30px;">
                        <button type="submit" class="btn btn-primary">Gerar Ordem de Servi√ßo</button>
                    </div>
                    </form>
                </div>
                </div>

                <!-- TAB BANCO DE OS -->
                <div id="banco" class="tab-content">
                    <div class="card">
                        <h3>üóÇÔ∏è Banco de Ordens de Servi√ßo</h3>
                        
                        <div class="search-box">
                            <input type="text" class="form-control" id="searchOS" placeholder="Buscar por nome do cliente...">
                        </div>

                        <div id="osListTable">
                            <p>Lista de ordens de servi√ßo aparecer√° aqui...</p>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="renderer.js"></script>
</body>
</html>